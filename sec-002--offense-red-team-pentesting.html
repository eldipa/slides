<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Slides</title>
		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
<link rel="stylesheet" href="dist/theme/white.css" id="theme">
		<!-- Theme used for syntax highlighted code -->
<link rel="stylesheet" href="plugin/highlight/zenburn.min.css" id="highlight-theme"></head>
	<body>
		<div class="reveal">
			<div class="slides" style="position: absolute; top: 50%;">
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--title-001-MainTitle.svg"  type="image/svg+xml" />
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Players-001-PlayersPresentation.svg"  type="image/svg+xml" />
notes:
En el plano ofensivo tenemos a 3 players: Red Team, Pentester y
Researcher (siendo el último el más alejado al campo de batalla)
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Players-002-RedTeam.svg"  type="image/svg+xml" />
notes:
El Red Team es un equipo multidisciplinario que cubre todos los aspectos
de seguridad: físicos, personas y software.

Pensa en un equipo que puede planear como entrar a un edificio
lockpickeando las cerraduras, ir al datacenter abriendose paso con
tarjetas de acceso clonadas y plantando software q vulnere a una empresa
desde adentro.

Muy hardcore? Imaginete una campaña de investigación viendo los gustos
personales del admin (IT) para enviarle un mail específicamente
targeteado para que se instale un software y tomar control de su
desktop, y de ahí, de toda la infra.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Players-003-RedTeamGoal.svg"  type="image/svg+xml" />
notes:
El objetivo es simular ataques reales, probar las
defensas de una organización y ver que puntos flojos tiene.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Players-004-Pentester.svg"  type="image/svg+xml" />
notes:
Un pentester es una persona más especializada.

Los hay especialistas en
apps web, apps de android, en hardware. Obviamente que cuanto mas hábil
es el pentester más areas cubre.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Players-005-PentesterGoal.svg"  type="image/svg+xml" />
notes:
El objetivo es encontrar (y
probar) vulnerabilidades pero sin explotarlas. Esto es, sin tomar
ventaja de ellas.

No hay una diferencia clara de que es un Red Team y un Pentester.

Es fácil verla si uno compara un grupo de hackers capaces de entrar
a un edificio, vulnerar las tarjetas de acceso y pawnear los datacenters
y compara eso con una sola persona que solo revisa código de una app
web.

Pero hay todo un abanico de opciones entre ambos extremos.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Players-006-Researcher.svg"  type="image/svg+xml" />
notes:
Los researchers (investigadores) son un bicho aparte: altamente especializados en un area,
suelen estar lejos del campo de batalla.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Players-007-ResearcherGoal.svg"  type="image/svg+xml" />
notes:
Se enfocan en encontrar vulnerabilidades y ataques nuevos.

A diferencia de un pentester que busca un SQLi en una app, un researcher
busca nuevas formas de realizar un SQLi en general.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Players-010-Synenergy.svg"  type="image/svg+xml" />
notes:
Hay una sinergia entre las disciplinas: un red team tiene pentesters en
su equipo, los pentesters/red teams aprenden de las nuevas técnicas
ideadas por los researchers, tanto los miembros de un red team como los
pentesters suelen investigar cosas por su cuenta.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Players-011-Jobs.svg"  type="image/svg+xml" />
notes:
Que motivación tiene cada uno?

Una empresa puede contratar los servicios de un red team / pentester
para realizar una consultoría / auditoria (algunas empresas tienen
equipos in-house, otras contratan equipos externos).

En otros casos, hay organizaciones que pagan por una recompensa a aquel
que encuentra una vulnerabilidad en su software, los bug bounties.

Y los researchers?

Los resultados de investigación o bien se hacen
públicos (cuando los researchers trabajan en la academia) o bien
terminan siendo usados por empresas privadas para sus productos de
seguridad.

Una empresa `X` cuyo producto es la automatización de ataques para
pentesters/red team cuenta entre sus empleados researchers que
encuentran nuevas vulns y ataques.

O, una empresa `Y` que ofrece logins de Windows con biometria, requiere
de researchers para entender como funciona el login de Windows,
hackearlo e integrar el login biometrico (por que Windows no ofrece
forma ni documentación).
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Players-008-FullDisclosure.svg"  type="image/svg+xml" />
notes:
A todo esto, que se hace cuando se encuentra una vulnerabilidad?

Los red team/pentesters la reportan como parte de sus informes a sus
clientes (cuando hay un contrato de por medio) o la reportan por una
recompensa (bug bounty).

En general no hay forma de enforzar que toda vulnerabilidad sea
reportada. Es la ética de la persona / empresa para la que trabaja.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Players-009-Allowed.svg"  type="image/svg+xml" />
notes:
Y que tan legal es?

Hay cosas que son fundamentalmente ilegales como suplantación de
identidad (enviar mails a nombre de otra persona).

Otras son legales condicionado a que se tenga un permiso explícito.
Entrar a un edificio es ilegal salvo que se tenga un permiso.

Para un red team/pentester es esencial tener firmado un contrato con el
cliente para protegerse legalmente. Un researcher dependerá de la
situación (por ejemplo, hackear tu propia computadora por que estas
investigando un nuevo ataque no es ilegal, hackear la de tu vecino si).
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-001-Scope.svg"  type="image/svg+xml" />
notes:
Veamos un ejemplo.

Tenemos un cliente que quiere realizar un pentest
y contrata los servicios de un red team.

Que se quiere lograr? se quiere pawnear la
DB? se quiere ver si es posible acceder físicamente al datacenter?

Que se permite y que no se permite hacer? podemos interactuar con
los empleados? podemos explotar vulns sobre servicios en prod?
aca hay que considerar los aspecto legales y pedir permisos explícitos.

Que información inicial tenemos?: en un modelo black box
el red team arranca en cero siendo un escenario más realista para la
simulación de un ataque.

Sin embargo, idealmente se trata de convencer el cliente
de ir por un modelo grey/white box con mas información sobre la infra
para que el red team no pierda tanto tiempo buscando y se enfoque más
en el ataque.

Cuanto tiempo se dispone? Hay otras restricciones? Si surge un
problema, a quien se llama? (imaginate que el objetivo es entrar a un
edificio pero te descubren y llaman a la policía, a quien llamas?!)

Todo esto forma parte del alcance del proyecto.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-002-Engagement.svg"  type="image/svg+xml" />
notes:
Definido el scope se pasa al engage. Lease, la recolección de
información, búsqueda de vulnerabilidades, planning y ataque.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-003-Report.svg"  type="image/svg+xml" />
notes:
Al finalizar, se arma un reporte. No solo le decimos al cliente que
vulns encontramos sino también lo orientamos en como arreglarlas y
priorizarlas.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-004-ReconVulnFindExploit.svg"  type="image/svg+xml" />
notes:
El engage es el core: hay diferentes etapas pero a alto nivel se
encuentran 3: recon/IG, find vulns y exploit.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-005-Recon.svg"  type="image/svg+xml"/>
notes:
Information Gathering (IG) / Reconnaissance (recon)

Que hay? Que máquinas esta corriendo? Que puertos están abiertos? Que
servicios, que versiones estan live? Que personas tienen acceso? Que
roles hay?

IG/Recon busca ver donde esta cada cosa y como se conectan las piezas.

En un modelo white box el cliente le puede suministrar al red team info
de todo lo que hay en la infra, de tal forma que sea más sencillo
planear los ataques.

En un modelo black box hay que buscar todo desde cero.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-006-ReconGoal.svg"  type="image/svg+xml" />
notes:
En resumen: tener visibilidad y saber que hay.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-007-VulnFind.svg"  type="image/svg+xml" />
notes:
Find Vulns

De lo que se descubra en la etapa de recon se busca que cosas pueden ser
vulnerables.

Hay máquinas accesibles por red que no debería estarlo? Hay puertos
abiertos que no deberían estarlo? Hay servicios corriendo con versiones
viejas vulnerables? Hay roles que tienen demasiados accesos?

Se busca que se puede leer / escribir / ejecutar que uno no debería.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-008-VulnFindGoal.svg"  type="image/svg+xml" />
notes:
Se buscan todas las vulns posibles, pero en lo posible se orientan a
aquellas que sean relevantes:

 - una máquina interna respondió un ping? -> *bullshit*
 - tiene el SSH abierto con credenciales por default? -> *that's a cookie!*
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-009-VulnFindGoal2.svg"  type="image/svg+xml" />a
notes:
Se buscan vulns que nos permitan movernos dentro de la
empresa: leer / escribir / ejecutar cosas que no deberíamos. Tener
accesos que no deberíamos.

Esto es lo que habilita *avanzar y encontrar aun más cosas*.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-010-Exploit.svg"  type="image/svg+xml" />
notes:
Exploit!

Es el uso de una vuln a nuestra ventaja.

No toda vuln es exploitable: una vulnerabilidad puede existir pero puede
que no se pueda ejecutar o hacer algo útil con ella. La vuln se reporta
igualmente pero no sirve para adquirir más accesos.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-011-ExploitGoal.svg"  type="image/svg+xml" />
En que se traduce?

 - En tener más privilegios
 - Moverse lateralmente
 - Poder ver más (habilitar mas IG/Recon)

</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Pentest-012-ExploitGoal2.svg"  type="image/svg+xml" />
notes:
El objetivo de explotar vulns es la de poder habilitar a mas recon y
find vulns.

Atacar a un servicio remoto para forzarlo a ejecutar código arbitrario,
instalarle un agente y obtener shell nos permite ahora realizar recon
desde esa maquina, ver que vulns tiene esa maquina, que accesos podemos
robar.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-001-Scope.svg"  type="image/svg+xml" />
notes:
Supongamos que nuestro cliente nos dice:

 - objetivo: filtrar la DB de producción
 - que se puede/no se puede hacer: ...
 - blackbox-model: solo te dire que hay 2 IPs públicas accesibles: la `.47` y la `.48`.

Si bien el objetivo es filtrar la DB de producción, si la DB contiene
datos privados sensibles de usuarios reales podríamos estar incurriendo
en un delito. Por lo tanto, el objetivo real va a ser *probarle* al
cliente que se puede filtrar toda la DB sin hacerlo.

</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-002-StartingPoint.svg"  type="image/svg+xml" />
notes:
Y que hacemos?
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-003-HostDiscovery.svg"  type="image/svg+xml" />
notes:
Recon!

Podemos usar `nmap` para ver si los hosts y que puertos están activos.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-004-OSDetection.svg"  type="image/svg+xml" />
notes:
Se puede inferir que OS están corriendo.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-005-ServiceDetection.svg"  type="image/svg+xml" />
notes:
Y que servicios.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-006-NowWhat.svg"  type="image/svg+xml" />
notes:
Y ahora, que hacemos?
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-007-ReconLogin.svg"  type="image/svg+xml" />
notes:
Más Recon!

Si tenemos un server HTTP podríamos ver si podemos explotarlo pero este
camino hay que descartarlo por que el cliente explícitamente nos dijo
*"nada de atacar un servicio"*.

Entonces, solo podemos tratar de logguearnos y ver si hay algo mas
detras.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-008-LoginFails.svg"  type="image/svg+xml" />
notes:
Probamos mails y passwords pero nada.

Podríamos tratar de engañar a un empleado para que nos de acceso, pero
el cliente explícitamente nos dijo *"nada de ingeniería social"*.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-009-CreateAccountFails.svg"  type="image/svg+xml" />
notes:
Tal vez podemos crearnos una cuenta?

Nope.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-010-PassRecoveryFails.svg"  type="image/svg+xml" />
notes:
Tal vez podemos abusar del mecanismo de password recovery?

Nope.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-011-LoginToTest.svg"  type="image/svg+xml" />
notes:
En general, las cosas **no** son vulnerables. Por eso IG/Recon es
importantísimo por que nos permite encontrar muchas más cosas con las
que luego intentar romper.

En la `.47` no tuvimos suerte, pero en la `.48` si!
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-012-TrySQLi.svg"  type="image/svg+xml" />
notes:
A encontrar vulnerabilidades!

Probando con `john' or 1=1` y similares, estamos:

 - viendo si hay un SQL corriendo detras
 - que el input es vulnerable a un SQL Injection (SQLi)
 - y según como se comporte, hasta podemos saber que base de datos es

</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-013-SQLi.svg"  type="image/svg+xml" />
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-014-Postgres.svg"  type="image/svg+xml" />
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-015-ProdPostgres.svg"  type="image/svg+xml" />
notes:
En un pentest estamos trabajando siempre con supuestos.

Si `.48` tiene usuarios de testing, es probable (aunque no confirmado)
que la `.47` sea la máquina de producción.

Si la `.48` tiene un Postgres, la `.47` también.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-016-ExploitSQLi.svg"  type="image/svg+xml" />
notes:
Exploit!

Inyectando algunas queries no solo podemos saber que hay Postgres sino
también que version esta corriendo y con que usuario/role en la DB estamos
ejecutándolas.

Con esa info podemos armar el exploit: una query que nos de un reverse-shell
en la máquina que esta hosteando la DB.

La idea es que se ejecute un programa en la máquina de la DB que se
conecte hacia nuestros servidores para nosotros usar esa conexión y
establecer un shell.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-017-ReconDBHost.svg"  type="image/svg+xml" />
notes:
Y ahora?

Más IG/Recon!

Que procesos estan corriendo? Que usuarios hay? Que puertos estan en
uso?
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-018-AgentDeploy.svg"  type="image/svg+xml" />
notes:
El IG/Recon nos dió que en la máquina de la DB hay un Apache y que esta
siendo usado el mismo puerto `7172` y que la IP publica es la `.48`.

Conclusion?

La máquina donde esta la DB y donde esta el Apache son la misma!

Y esto tiene sentido: en ambientes de testing muchas veces uno levanta
toda la infra en una única máquina.

En un pentesting siempre se trabajan con supuestos y a medida que se
avanza en el engage hay que ir cambiándolos.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-019-InnerScan.svg"  type="image/svg+xml" />
notes:
Y ahora? Más IG/Recon.

Ya desde adentro de la red del cliente, un `nmap` va a revelar cosas que
desde afuera no estaban visibles.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-020-InnerDNS.svg"  type="image/svg+xml" />
notes:
Y encontramos un DNS server.

Un DNS server no solo mapea hostnames a IPs sino, muchas veces, IPs
a hostnames.

Que mejor forma de aprender que rol cumple cada máquina en la red
que preguntándole a un DNS server! Un saludo al personal de IT por
simplificarnos el trabajo!
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-021-Mapping.svg"  type="image/svg+xml" />
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-022-PawnDbProd.svg"  type="image/svg+xml" />
notes:
Identificada la DB de producción, atacamos & profit.
</textarea></section>
<section data-markdown  ><textarea data-template>
<object data="frames/sec-002--Example-023-Report.svg"  type="image/svg+xml" />
notes:
El reporte a nuestro cliente no solo incluye el *attack path* o como
logramos acceder y robarnos la DB sino también que otras vulns vimos
en el camino y que medidas de seguridad deberían aplicarse.

No es solo bloquear una parte, es mejorar el todo: *sec in depth*.
</textarea></section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="plugin/math/math.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
Reveal.initialize({
controls : false,
markdown : {smartypants: true},
transition : "fade",
transitionSpeed : "fast",
backgroundTransition : "none",
showNotes : true,
disableLayout : true,
				hash: true,
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath ]
			});
		</script>
	</body>
</html>
